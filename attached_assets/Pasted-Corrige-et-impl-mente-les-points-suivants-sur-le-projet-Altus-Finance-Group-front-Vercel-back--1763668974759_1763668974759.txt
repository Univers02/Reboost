Corrige et implÃ©mente les points suivants sur le projet Altus Finance Group (front : Vercel / back : Render / DB : PostgreSQL).
Merci de suivre strictement chaque instruction.

1. Correction des limites dâ€™emprunt
Particulier

Le dashboard affiche actuellement :

CrÃ©dit disponible : 500 000 â‚¬ â€” OK

CapacitÃ© dâ€™emprunt : 50 000 â‚¬ â€” âŒ Incorrect
â¡ï¸ Corriger la capacitÃ© dâ€™emprunt pour quâ€™elle reflÃ¨te aussi le plafond rÃ©el de 500 000 â‚¬ pour les particuliers.

Professionnel

Harmoniser la mÃªme logique dans lâ€™espace PRO en utilisant les plafonds prÃ©vus cÃ´tÃ© back.

2. Statut des prÃªts : synchronisation Dashboard â†” Mes PrÃªts

ProblÃ¨me actuel :

Le tableau de bord affiche 2 prÃªts en attente

La section Mes prÃªts affiche 0 en attente

â¡ï¸ Corriger lâ€™incohÃ©rence.
Toutes les sections doivent se baser sur la mÃªme requÃªte et la mÃªme source de vÃ©ritÃ© :

select * from loans where user_id = ?;


Et filtrer correctement :

en_attente

approuvÃ©

rejetÃ©

dÃ©bloquÃ©

en_remboursement

terminÃ©

3. Remboursements Ã  venir

Pour chaque prÃªt finalisÃ©, ajouter automatiquement dans le dashboard :

La liste des mensualitÃ©s Ã  venir (montant, date, statut payÃ© / non payÃ©)

Source : table amortization_schedule (si inexistante â†’ la crÃ©er)

Format :

date_echeance
montant
principal
interet
statut


â¡ï¸ Ajouter un bouton / lien "Voir le plan d'amortissement"
Ce lien ouvre une page dÃ©taillÃ©e :

Montant empruntÃ©

DurÃ©e

Taux

MensualitÃ©

Tableau complet mois par mois

âš ï¸ Cette page nâ€™est accessible que si le prÃªt est approuvÃ© ET signÃ© ou si le transfert initial a Ã©tÃ© effectuÃ©.

4. NumÃ©ro de prÃªt : remplacer lâ€™UUID trop long

Actuellement :

PrÃªt #d1f0a9ef-3df9-4aba-86c5-d08738415154


â¡ï¸ Ajouter une fonction gÃ©nÃ©ratrice dâ€™ID propre :

Format attendu (pro & clean) :

ALT-P-2025-00147
ALT-I-2025-00893


RÃ¨gles :

Prefix ALT

P = Pro / I = Immo / C = Conso

AnnÃ©e en cours

Compteur auto incrÃ©mentÃ©

CrÃ©er une colonne loan_reference dans la table si inexistante.

5. Fiabiliser les endpoints API cÃ´tÃ© backend

VÃ©rifier et corriger si nÃ©cessaire :

/loans/user/:id

/loans/status-count/:id

/loans/amortization/:loanId

/dashboard/stats/:userId

Tous doivent renvoyer :

{
  success: true,
  data: ...
}

6. RafraÃ®chir le dashboard aprÃ¨s mise Ã  jour

AprÃ¨s un changement de statut de prÃªt :

forcer le front Ã  re-fetch via SWR ou React Query

Ã©viter les donnÃ©es pÃ©rimÃ©es en cache

7. VÃ©rification finale

Tout doit fonctionner en production sur :

Front : https://altusfinancesgroup.com

API : https://api.altusfinancesgroup.com

ğŸ¯ Objectif gÃ©nÃ©ral

Avoir un dashboard propre, cohÃ©rent et rÃ©ellement FinTech :

Statuts 100% synchronisÃ©s

CapacitÃ© dâ€™emprunt correcte

RÃ©fÃ©rences de prÃªts professionnelles

Remboursements Ã  venir visibles et liÃ©s au plan dâ€™amortissement

API harmonisÃ©e

Merci dâ€™appliquer toutes ces corrections proprement et dâ€™envoyer les patchs correspondants.